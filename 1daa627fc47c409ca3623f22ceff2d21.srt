WEBVTT

1
00:00:00.003 --> 00:00:01.003
- [Instructor] So we've talked about

2
00:00:01.003 --> 00:00:04.000
how to use tools, like ChatGPT and Bard,

3
00:00:04.000 --> 00:00:07.002
to generate or interpret Excel worksheet formulas.

4
00:00:07.002 --> 00:00:08.005
Now let's take it a step further

5
00:00:08.005 --> 00:00:10.002
and see if we can use those tools

6
00:00:10.002 --> 00:00:13.002
to generate DAX or M Code as well.

7
00:00:13.002 --> 00:00:14.002
So for this demo,

8
00:00:14.002 --> 00:00:17.001
what I've done is loaded up a simple movie table

9
00:00:17.001 --> 00:00:18.008
into Excel's data model.

10
00:00:18.008 --> 00:00:20.008
You can see I've got movie titles here,

11
00:00:20.008 --> 00:00:23.004
along with fields like genre, country, rating,

12
00:00:23.004 --> 00:00:26.000
IMDB score, and gross revenue.

13
00:00:26.000 --> 00:00:27.009
Now suppose we want to do some analysis

14
00:00:27.009 --> 00:00:30.007
and understand average IMDB scores

15
00:00:30.007 --> 00:00:33.007
for different combinations of genre and rating.

16
00:00:33.007 --> 00:00:34.008
Well, one way to do that

17
00:00:34.008 --> 00:00:37.006
would be to use a PivotTable, like so.

18
00:00:37.006 --> 00:00:40.001
You can drop it right here into our worksheet.

19
00:00:40.001 --> 00:00:42.004
Let's go ahead and activate our Field list.

20
00:00:42.004 --> 00:00:44.003
And suppose we care specifically

21
00:00:44.003 --> 00:00:47.005
about the average IMDB score.

22
00:00:47.005 --> 00:00:48.009
Go ahead and change the Field Settings

23
00:00:48.009 --> 00:00:55.007
from Sum to Average for PG-13 rated films specifically.

24
00:00:55.007 --> 00:01:01.005
we'll filter down to just PG-13, and only for Action titles.

25
00:01:01.005 --> 00:01:04.005
Filter, genre equals action as well.

26
00:01:04.005 --> 00:01:06.000
So that gives us our answer.

27
00:01:06.000 --> 00:01:08.000
The average IMDB score

28
00:01:08.000 --> 00:01:12.001
for PG-13 rated action movies is 6.36.

29
00:01:12.001 --> 00:01:16.002
Now let's see if ChatGPT can generate a DAX measure

30
00:01:16.002 --> 00:01:19.001
to produce this exact same value.

31
00:01:19.001 --> 00:01:21.000
All right, so here in ChatGPT,

32
00:01:21.000 --> 00:01:22.008
I'm going to go ahead and paste my prompts.

33
00:01:22.008 --> 00:01:25.006
I'm saying, "I have a table named Movies containing fields

34
00:01:25.006 --> 00:01:28.003
for genre, rating, and IMDB score.

35
00:01:28.003 --> 00:01:29.007
Can you please create a DAX measure

36
00:01:29.007 --> 00:01:32.003
to calculate the average IMDB score

37
00:01:32.003 --> 00:01:35.004
for PG-13 rated action movies?"

38
00:01:35.004 --> 00:01:37.005
Let's see what we get back.

39
00:01:37.005 --> 00:01:40.003
So certainly, you can use the following measure.

40
00:01:40.003 --> 00:01:41.009
Looks like it's using a Calculate function,

41
00:01:41.009 --> 00:01:43.004
which is what I would do.

42
00:01:43.004 --> 00:01:45.004
Average IMDB score

43
00:01:45.004 --> 00:01:48.002
with two filter arguments for genre and rating.

44
00:01:48.002 --> 00:01:50.004
So at first glance, this looks great.

45
00:01:50.004 --> 00:01:52.007
Gives a nice little summary here as well

46
00:01:52.007 --> 00:01:55.003
and reminds us to replace these labels

47
00:01:55.003 --> 00:01:57.003
with the actual table names.

48
00:01:57.003 --> 00:01:59.002
And in this case, these actually match perfectly,

49
00:01:59.002 --> 00:02:02.004
so hopefully, this will be as simple as plug and play.

50
00:02:02.004 --> 00:02:04.002
So let's copy that code,

51
00:02:04.002 --> 00:02:07.002
and let's head back to Excel and give this a shot.

52
00:02:07.002 --> 00:02:09.002
All right, so from our Power Pivot tab,

53
00:02:09.002 --> 00:02:11.007
let's go ahead and create a new measure.

54
00:02:11.007 --> 00:02:13.002
I'm going to paste everything that I had

55
00:02:13.002 --> 00:02:15.003
from ChatGPT right here.

56
00:02:15.003 --> 00:02:17.005
This is actually our measure name.

57
00:02:17.005 --> 00:02:19.009
Copy that, paste it here,

58
00:02:19.009 --> 00:02:22.009
and then delete everything before this equal sign.

59
00:02:22.009 --> 00:02:25.004
And now we should be able to check that formula.

60
00:02:25.004 --> 00:02:26.008
Looks good. No errors.

61
00:02:26.008 --> 00:02:28.004
We can apply a format.

62
00:02:28.004 --> 00:02:32.009
Let's do decimal with two places, and press OK.

63
00:02:32.009 --> 00:02:33.007
And check that out.

64
00:02:33.007 --> 00:02:37.008
The measure that ChatGPT produced was exactly correct.

65
00:02:37.008 --> 00:02:41.004
It gave us that correct answer of 6.36.

66
00:02:41.004 --> 00:02:44.002
So really, really impressed with that use case.

67
00:02:44.002 --> 00:02:45.000
Next up, let's see

68
00:02:45.000 --> 00:02:47.003
if we can actually produce this same value

69
00:02:47.003 --> 00:02:51.000
but this time, using M code inside of Power Query.

70
00:02:51.000 --> 00:02:52.001
So to do that we're going to head

71
00:02:52.001 --> 00:02:54.009
to Data, Queries & Connections.

72
00:02:54.009 --> 00:02:59.000
We see this Movie query where I loaded up my CSV file.

73
00:02:59.000 --> 00:03:02.001
Let's Edit to open up the Power Query editor.

74
00:03:02.001 --> 00:03:04.006
And you can see there have been a few steps applied

75
00:03:04.006 --> 00:03:07.000
to reference the source data, promote the headers,

76
00:03:07.000 --> 00:03:08.006
change some data types,

77
00:03:08.006 --> 00:03:10.009
and I don't want to overwrite all of that.

78
00:03:10.009 --> 00:03:13.006
So what I've found in working with ChatGPT

79
00:03:13.006 --> 00:03:17.002
for M functions is that it's best to go to the Home tab,

80
00:03:17.002 --> 00:03:19.003
open up the Advanced Editor,

81
00:03:19.003 --> 00:03:22.002
and copy all of the existing M code here

82
00:03:22.002 --> 00:03:25.006
and asking ChatGPT to modify this code

83
00:03:25.006 --> 00:03:28.002
instead of creating new code from scratch.

84
00:03:28.002 --> 00:03:29.009
So let's go ahead and copy this.

85
00:03:29.009 --> 00:03:31.002
We'll press Done.

86
00:03:31.002 --> 00:03:33.003
Let's go back into ChatGPT.

87
00:03:33.003 --> 00:03:36.000
Let's paste that code here,

88
00:03:36.000 --> 00:03:40.000
and let's also give it a little bit of context as well.

89
00:03:40.000 --> 00:03:41.006
I'm just going to just add a little prompt

90
00:03:41.006 --> 00:03:43.005
before the code that says,

91
00:03:43.005 --> 00:03:46.001
"Can you please modify the following M code

92
00:03:46.001 --> 00:03:50.003
to add a step calculating average IMDB rating grouped

93
00:03:50.003 --> 00:03:52.004
by genre and rating?"

94
00:03:52.004 --> 00:03:54.003
Now let's cross our fingers,

95
00:03:54.003 --> 00:03:57.009
Submit, and see what we get back.

96
00:03:57.009 --> 00:03:59.007
All right, so far so good.

97
00:03:59.007 --> 00:04:02.007
It says to add a step calculating average IMDB rating

98
00:04:02.007 --> 00:04:04.001
grouped by genre and rating,

99
00:04:04.001 --> 00:04:07.000
you can modify the M code as follows.

100
00:04:07.000 --> 00:04:09.003
Gives us a nice little block of code.

101
00:04:09.003 --> 00:04:10.007
Let's go ahead and copy it.

102
00:04:10.007 --> 00:04:12.004
Let's head back to Excel,

103
00:04:12.004 --> 00:04:15.002
and we can go back to our Advanced Editor.

104
00:04:15.002 --> 00:04:18.002
And I'm just going to select everything, delete it,

105
00:04:18.002 --> 00:04:21.003
and paste what ChatGPT gave me.

106
00:04:21.003 --> 00:04:22.001
It says, "No errors."

107
00:04:22.001 --> 00:04:23.007
That's a good sign.

108
00:04:23.007 --> 00:04:25.008
Press Done and check that out.

109
00:04:25.008 --> 00:04:27.003
It added a step.

110
00:04:27.003 --> 00:04:29.003
It's labeled it Grouped Rows.

111
00:04:29.003 --> 00:04:31.001
And what this is doing is it's calculating

112
00:04:31.001 --> 00:04:33.000
the average IMDB score

113
00:04:33.000 --> 00:04:35.007
for each combination of genre and rating.

114
00:04:35.007 --> 00:04:38.003
So to spot check our action, PG-13,

115
00:04:38.003 --> 00:04:42.007
you could go ahead and sort these, sort them ascending,

116
00:04:42.007 --> 00:04:46.002
Action, PG-13, 6.36.

117
00:04:46.002 --> 00:04:47.002
So there you have it.

118
00:04:47.002 --> 00:04:50.009
Overall, I'd give ChatGPT pretty high marks for this one.

119
00:04:50.009 --> 00:04:52.007
Both the DAX and M examples

120
00:04:52.007 --> 00:04:54.008
that we walked through were spot on.

121
00:04:54.008 --> 00:04:57.007
Granted, they were both relatively simple cases.

122
00:04:57.007 --> 00:04:59.004
Now for more complex queries,

123
00:04:59.004 --> 00:05:02.003
I imagine you need to do a bit more modification.

124
00:05:02.003 --> 00:05:06.004
But nevertheless, I'd be pretty confident using ChatGPT

125
00:05:06.004 --> 00:05:08.008
at least to give you a good starting point,

126
00:05:08.008 --> 00:05:10.006
especially if you aren't completely fluent

127
00:05:10.006 --> 00:05:11.007
with these languages.
